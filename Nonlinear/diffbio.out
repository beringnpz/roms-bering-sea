24a25
> !      USE mod_ice
26,30d26
< #if defined BERING_10K  
< #if defined ICE_BIO   
<       USE mod_ice
< #endif
< #endif
76,80c72,74
< #elif defined BERING_10K
<      &                   ,ICE(ng) % IcePhL                              &
<      &                   ,ICE(ng) % IceNO3                              &
<      &                   ,ICE(ng) % IceNH4                              &  
<      &                   ,ICE(ng) % IceLog                              &  
---
> #else
>      &                   ,ICE(ng) % it                                  &
>      &                   ,ICE(ng) % itL                                 &
134,138c128,130
< #elif defined BERING_10K    
<      &                            , IcePhL                              &
<      &                            , IceNO3                              &
<      &                            , IceNH4                              &
<      &                            , IceLog                              &
---
> #else     
>      &                            ,it                                   &
>      &                            ,itL                                  &
174,179c166
< #if defined BERING_10K  
< #if defined ICE_BIO   
<       USE mod_ice
< #endif
< #endif
< 
---
> !      USE mod_ice
234d220
< #ifdef CLIM_ICE_1D 
237c223
<      
---
> #ifdef CLIM_ICE_1D      
240,241c226
<   
< #elif defined BERING_10K
---
> #else      
246,249d230
<       real(r8), intent(inout) :: IcePhL(LBi:,LBj:,:)
<       real(r8), intent(inout) :: IceNO3(LBi:,LBj:,:)
<       real(r8), intent(inout) :: IceNH4(LBi:,LBj:,:)
<      real(r8), intent(inout) :: IceLog(LBi:,LBj:,:)  
251d231
< 
282d261
< #ifdef CLIM_ICE_1D
285c264
< 
---
> #ifdef CLIM_ICE_1D
288c267
< #elif defined BERING_10K     
---
> #else      
293,296d271
<       real(r8), intent(inout) :: IcePhL(LBi:UBi,LBj:UBj,2)
<       real(r8), intent(inout) :: IceNO3(LBi:UBi,LBj:UBj,2)
<       real(r8), intent(inout) :: IceNH4(LBi:UBi,LBj:UBj,2)
<       real(r8), intent(inout) :: IceLog(LBi:UBi,LBj:UBj,2)
322c297
<       real(r8) :: dtdays, Ra, Rf
---
>       real(r8) :: dtdays
328c303
<       real(r8) :: Iron1, kfePh,respPh,BasalMet,BasalMetJel
---
>       real(r8) :: Iron1, kfePh,respPh,BasalMet
490,492c465,467
< 	 ice_thick(i,j) = tclm(i,j,N(ng),i1CI) 
< #elif defined BERING_10K   
<          if (ai(i,j,nstp).gt.0.0_r8)THEN 
---
> 	 ice_thick(i,j) = tclm(i,j,N(ng),iFe+1) 
> #else
> 
495,498d469
<          else
<          ice_thick(i,j)=0.0_r8
<          end if
<      
569,570d539
< 	  
< # ifdef CLIM_ICE_1D	  
584,602c553,554
< 	      endif
< #elif defined BERING_10K
< 
<            if (IceLog(i,j,nstp).le.0 )  THEN
< 	         
< ! Initialize the ice biology
< 
<               IcePhL(i,j,nstp) = 1.1638_r8  !0.1638_r8       
<               IceNO3(i,j,nstp) = Bio(i,N(ng),iNO3)  !5.0_r8        
<               IceNH4(i,j,nstp) = Bio(i,N(ng),iNH4)  !1.0_r8       
<               IceLog(i,j,nstp) =1.0_r8 
< ! Bio(i,k,iNO3)
<               IcePhL(i,j,nnew) = IcePhL(i,j,1)       
<               IceNO3(i,j,nnew) = IceNO3(i,j,1)      
<               IceNH4(i,j,nnew) = IceNH4(i,j,1)        
<               IceLog(i,j,nnew) = IceLog(i,j,1)
<            endif
< # endif	      
<             
---
> 	      
>             endif
607c559
< # ifdef CLIM_ICE_1D       
---
>        
616,619c568
< #elif defined BERING_10K
<      
<      
< # endif
---
> 
721c670
<      &                   Bio(i,N(ng),iPhL)/ccrPhL)**(-0.1_r8)
---
>      &                   Bio(i,N(ng),iPhL)/ccrPhL)**(0.428_r8)
760c709
<      &                       Bio(i,k+1,iPhL)/ccrPhL)**(-0.1_r8))     
---
>      &                       Bio(i,k+1,iPhL)/ccrPhL)**(0.428_r8))     
762c711
<      &                       Bio(i,k,iPhL)/ccrPhL)**(-0.1_r8))        
---
>      &                       Bio(i,k,iPhL)/ccrPhL)**(0.428_r8))        
875c824
<              Pmax = (2.0_r8 ** Drate - 1.0_r8 )   !maximum daily mass specific growth rate FROST (1987)
---
>              Pmax = (2.0_r8 ** Drate - 1.0_r8 ) 
877c826
<              Pmaxs=Pmax*ccr !max chla specific growth rate from FROST (1987)
---
>              Pmaxs=Pmax*ccr
919c868
< #ifdef IRON_LIMIT
---
> #ifdef IRON
953d901
<      
1037c985
< #ifdef IRON_LIMIT
---
> #ifdef IRON
1049c997
<                 Stat3(i,k,5)= PAR(i,k)
---
>                 Stat3(i,k,5)= Pmax
1154c1102
< #ifdef IRON_LIMIT
---
> #ifdef IRON
1302c1250
< #ifdef IRON_LIMIT
---
> #ifdef IRON
1760c1708,1709
<      &               + fpPhLEup * (BioBI(i,iIcePhL)/Hz(i,j,N(ng)))**2 
---
>      &               + fpPhLEup * (BioBI(i,iIcePhL)/aidz)**2 
> !g     &               + fpPhLEup * (BioBI(i,iIcePhL)/Hz(i,j,N(ng)))**2 
1802c1751
< 	Stat3(i,k,3)=gammaEup * cff1 * cff2 * cff3 * dtdays
---
> 	Stat3(i,k,3)=cff1!fpPhLEup * (Bio(i,k,iPhL)**2) * cff2 * cff3 * dtdays
2022c1971,1972
<      &               + fpPhLEup * (BioBI(i,iIcePhL)/Hz(i,j,N(ng)))**2 
---
>      &               + fpPhLEup * (BioBI(i,iIcePhL)/aidz)**2 
> !     &               + fpPhLEup * (BioBI(i,iIcePhL)/Hz(i,j,N(ng)))**2 
2048c1998
< 		
---
> !g		cff2 = eEup * 1.0_r8 / (fEup + cff1)
2053c2003
< 		
---
> !g		cff3=1.0_r8
2087,2088c2037
< !	  Stat3(i,k,14)= fpMZLEup * (Bio(i,k,iMZL)**2) &
< !     & * cff2 * cff3 * dtdays
---
> 	  Stat3(i,k,14)=gammaEup * cff1 * cff2 * cff3 * dtdays
2252,2256d2200
< !g                 TempFuncPhS(i,k) = GetPhytoResp2(Temp1,TmaxPhS,        &
< !g     &              KtBm_PhS)
< !g                 TempFuncPhL(i,k) = GetPhytoResp2(Temp1,TmaxPhL,        &
< !g     &              KtBm_PhL)
<      
2258c2202
<      &                    mPhS* Bio(i,k,iPhS) * dtdays
---
>      &                       mPhS * Bio(i,k,iPhS) * dtdays
2260c2204
<      &                   mPhL* Bio(i,k,iPhL) * dtdays
---
>      &                       mPhL * Bio(i,k,iPhL) * dtdays
2318c2262
< !                DBio(i,k,iMZS) = DBio(i,k,iMZS) -                    &
---
> !                DBio(i,k,iMZS) = DBio(i,k,iMZS) -                     &
2358,2363c2302,2305
<                
<               TFEup = Q10Eup ** ( (Bio(i,k,itemp)-Q10EupT) / 10.0_r8)
< 	      TFCop = Q10Cop ** ( (Bio(i,k,itemp)-Q10CopT)/10.0_r8)
<               TFNCa = Q10NCa ** ( (Bio(i,k,itemp)-Q10NCaT)/10.0_r8)
<           
< 	  
---
> 
> 
>                    cff3 = Q10Eup ** ( (Bio(i,k,itemp)-Q10EupT) / 10.0_r8 )
>               
2374,2382c2316,2324
<      &                      TFCop*mpredCop*dtdays*Bio(i,k,iCop)**2
<                DBio(i,k,iNCaS) = DBio(i,k,iNCaS) -                  &
<      &                      TFNCa*mpredNCa*dtdays*Bio(i,k,iNCaS)**2
<                DBio(i,k,iEupS) = DBio(i,k,iEupS) -                  &
<      &                      TFEup*mpredEup*dtdays*Bio(i,k,iEupS)**2
<                DBio(i,k,iNCaO) = DBio(i,k,iNCaO) -                  &
<      &                      TFNCa*mpredNCa*dtdays*Bio(i,k,iNCaO)**2
<                DBio(i,k,iEupO) = DBio(i,k,iEupO) -                  &
<      &                      TFEup*mpredEup*dtdays* Bio(i,k,iEupO)**2  
---
>      &                         cff3*mpredCop*dtdays*Bio(i,k,iCop)**2
>                DBio(i,k,iNCaS) = DBio(i,k,iNCaS) -                    &
>      &                         cff3*mpredNCa*dtdays*Bio(i,k,iNCaS)**2
>                DBio(i,k,iEupS) = DBio(i,k,iEupS) -                    &
>      &                         cff3*mpredEup*dtdays*Bio(i,k,iEupS)**2
>                DBio(i,k,iNCaO) = DBio(i,k,iNCaO) -                    &
>      &                         cff3*mpredNCa*dtdays*Bio(i,k,iNCaO)**2
>                DBio(i,k,iEupO) = DBio(i,k,iEupO) -                    &
>      &                         cff3* mpredEup*dtdays* Bio(i,k,iEupO)**2  
2407,2411c2349,2353
<      &                   +(TFCop*mpredCop * Bio(i,k,iCop)**2              &
<      &                   + TFNCa*mpredNCa * Bio(i,k,iNCaS)**2             &
<      &                   + TFEup*mpredEup * Bio(i,k,iEupS)**2             &
<      &                   + TFNCa*mpredNCa * Bio(i,k,iNCaO)**2             &
<      &                   + TFEup*mpredEup * Bio(i,k,iEupO)**2             &
---
>      &                   +(cff3*mpredCop * Bio(i,k,iCop)**2              &
>      &                   + cff3*mpredNCa * Bio(i,k,iNCaS)**2             &
>      &                   + cff3*mpredEup * Bio(i,k,iEupS)**2             &
>      &                   + cff3*mpredNCa * Bio(i,k,iNCaO)**2             &
>      &                   + cff3*mpredEup * Bio(i,k,iEupO)**2             &
2416c2358,2359
<              
---
>                  if(i.eq.3)  THEN		
>            if(j.eq.3) THEN 
2435c2378,2379
<      
---
>          endif
>         endif
2443c2387
<      &             mpredCop*dtdays*xi*Bio(i,k,iCop)**2
---
>      &             cff3*mpredCop*dtdays*xi*Bio(i,k,iCop)**2
2446c2390
<      &             mpredNCa*dtdays*xi*Bio(i,k,iNCaS)**2   
---
>      &             cff3*mpredNCa*dtdays*xi*Bio(i,k,iNCaS)**2   
2449c2393
<      &             mpredEup*dtdays*xi*Bio(i,k,iEupS)**2 
---
>      &             cff3*mpredEup*dtdays*xi*Bio(i,k,iEupS)**2 
2451c2395
<      &             mpredNCa*dtdays*xi*Bio(i,k,iNCaO)**2   
---
>      &             cff3*mpredNCa*dtdays*xi*Bio(i,k,iNCaO)**2   
2454c2398
<      &             mpredEup*dtdays*xi*Bio(i,k,iEupO)**2            
---
>      &             cff3*mpredEup*dtdays*xi*Bio(i,k,iEupO)**2            
2493c2437
< #ifdef IRON_LIMIT
---
> #ifdef IRON
2544c2488
< #ifdef IRON_LIMIT
---
> #ifdef IRON
2611c2555
< !g        cff1 = fpPhSMZL * Bio(i,k,iPhS)+ fpPhLMZL * Bio(i,k,iPhL)
---
>  !g        cff1 = fpPhSMZL * Bio(i,k,iPhS)+ fpPhLMZL * Bio(i,k,iPhL)
2672,2677c2616,2621
< !g     if(i.eq.2) THEN	
< !g         if(j.eq.2) THEN
< !g	Stat3(i,k,9)=TFMZL* BasalMetMZL*dtdays
< !g       
< !g        endif
< !g         endif
---
>      if(i.eq.2) THEN	
>          if(j.eq.2) THEN
> 	Stat3(i,k,9)=TFMZL* BasalMetMZL*dtdays
>        
>         endif
>          endif
2717,2722d2660
<  
< 		if(cff1.gt.1.0_r8)THEN  !0.05
< 		 BasalMetCop= respCop 
<  	        else
< 		 BasalMetCop=(cff1/1.0_r8)* respCop !0.05
< 		  endif 
2724,2727c2662,2666
< !g                if(cff1.lt.0.001_r8)THEN
< !g                BasalMetCop=respCop*0.1_r8
< !g                else
< !g                  BasalMetCop=respCop 
---
> 
>                 if(cff1.lt.0.01_r8)THEN
>                 BasalMetCop=respCop*cff1/0.01_r8
>                 else
>                   BasalMetCop=respCop 
2729c2668
< !g                 end if
---
>                  end if
2735,2736c2674,2675
<   
<             TFCop = Q10Cop ** ( (Bio(i,k,itemp)-Q10CopT)/10.0_r8)
---
>             TFCop = exp(ktbmC * (Bio(i,k,itemp) - TrefC))
> !            TFCop = Q10Cop ** ( (Bio(i,k,itemp)-Q10CopT)/10.0_r8)
2741c2680,2681
<            TFNCa = Q10NCa ** ( (Bio(i,k,itemp)-Q10NCaT)/10.0_r8)
---
>            TFNCa = exp(ktbmN * (Bio(i,k,itemp) - TrefN))
> !           TFNCa = Q10NCa ** ( (Bio(i,k,itemp)-Q10NCaT)/10.0_r8)
2746c2686,2687
<             TFEup = Q10Eup ** ( (Bio(i,k,itemp)-Q10EupT) / 10.0_r8 )
---
> !            TFEup = Q10Eup ** ( (Bio(i,k,itemp)-Q10EupT) / 10.0_r8 )
>             TFEup = exp(ktbmE * (Bio(i,k,itemp) - TrefE))
2761,2800d2701
<                if(yday.gt.105_r8.and.yday.lt.260)THEN
< 	       Ra=0_r8
< 	       else if(yday.ge.305)THEN
< 	       Ra=-0.5_r8
< 	        else if(yday.le.60)THEN
<          	Ra=-0.5_r8
< 		else if(yday.gt.60.and.yday.lt.105)THEN
< 		  Ra=((0.5_r8/(105-60))*(yday-60))-0.5_r8
< 		else if(yday.gt.260.and.yday.lt.305)THEN
< 		 Ra=((-0.5_r8/(305-260))*(yday-260))
<    	       end if
< 		
< 		if(cff1.gt.0.005_r8)THEN
< 		Rf=1_r8
< 		  else
< 		   Rf=cff1/0.005_r8
< 		  endif 
< !		BasalMetEup= respEup*(1+Rf+Ra);
< !g		BasalMetEup= respEup*Rf;
< 
< 
< !g                if(cff1.lt.0.001_r8)THEN
< !g                BasalMetEup=respEup*0.1_r8
< !g                 else
< !g                  BasalMetEup= respEup 
< !g                 end if
< 
< 
< 		if(cff1.gt.1.0_r8)THEN  !0.05_r8
< 		 BasalMetEup= respEup 
<  	        else
< 		 BasalMetEup=0_r8 !(cff1/1.0_r8)* respEup
< 		 end if 
< 
<                 if(cff2.gt.1.0_r8)THEN
< 		 BasalMetNCa= respNCa 
<  	        else
< 		 BasalMetNCa=(cff1/1.0_r8)* respNCa
< 		 end if 
< 		  
2802,2806c2703,2715
< !g                if(cff2.lt.0.001_r8)THEN
< !g                BasalMetNCa=respNCa*0.1_r8
< !g                else
< !g                BasalMetNCa=respNCa 
< !g                end if
---
>                 if(cff1.lt.0.01_r8)THEN
>                 BasalMetEup=respEup*cff1/0.01_r8
>                  else
>                   BasalMetEup= respEup 
>                  end if
> 
>                 if(cff2.lt.0.01_r8)THEN
> 
>                 BasalMetNCa=respNCa*cff2/0.01_r8
> 
>                else
>                   BasalMetNCa=respNCa 
>                  end if
2879c2788
< 	Stat3(i,k,10)= TFEup*BasalMetEup*Bio(i,k,iEupS)*dtdays
---
> 	Stat3(i,k,10)=TFEup*BasalMetEup*Bio(i,k,iEupS)*dtdays
2889,2894d2797
< 	if(i.eq.2) THEN	
<          if(j.eq.2) THEN
< 	Stat3(i,k,9)=Rf
<        
<         endif
<          endif
2901a2805
>        
2903,2920d2806
< 	        cff1 = fpCopJel * Bio(i,k,iCop)**2 +                      &
<      &		        fpNCaJel * Bio(i,k,iNCaS)**2 +                    &
<      &		        fpNCaJel * Bio(i,k,iNCaO)**2 +                    &
<      &                  fpEupJel * Bio(i,k,iEupS)**2 +                    &
<      &                  fpEupJel * Bio(i,k,iEupO)**2
<      
< !g               if(cff1.lt.0.001_r8)THEN
< !g                BasalMetJel=respJel*0.1_r8
< !g                else
< !g                BasalMetJel=respJel 
< !g                end if
< 
< !g                if(cff1.gt.1.0_r8)THEN  !.0.05
< !g		 BasalMetJel= respJel 
< !g 	        else
< !g		 BasalMetJel=(cff1/1.0_r8)* respJel
< !g		  end if 
< 		
2922c2808
<        
---
> !          TFJel = exp(ktbmJ * (Bio(i,k,itemp) - TrefJ))
2929c2815
<      &	 - TFJel *BasalMetJel* Bio(i,k,iJel)*dtdays	  
---
>      &	 - TFJel *respJel* Bio(i,k,iJel)*dtdays	  
2933c2819
<      &               xi*(TFJel*BasalMetJel*dtdays*Bio(i,k,iJel))
---
>      &               xi*(TFJel*respjel*dtdays*Bio(i,k,iJel))
2937c2823
< 	      Stat3(i,k,12)= Ra !TFJel *BasalMetJel* Bio(i,k,iJel)*dtdays	  
---
> 	      Stat3(i,k,12)= TFJel *respJel* Bio(i,k,iJel)*dtdays	  
2943c2829
<      &              TFJel*BasalMetJel*Bio(i,k,iJel)*dtdays
---
>      &              TFJel*respJel*Bio(i,k,iJel)*dtdays
2962c2848
<      &       TFJel*BasalMetJel*Bio(i,k,iJel)*dtdays*xi                                 
---
>      &       TFJel*respJel*Bio(i,k,iJel)*dtdays*xi                                 
3332c3218,3219
<      &                     +0.8_r8*(cff1)*dtdays  !includes 20% loss to N2
---
> !g     &                     +0.8_r8*(cff1)*dtdays  !includes 20% loss to N2
>      &                     +(cff1)*dtdays  
3387c3274
< 		  DBioB(i,k,iBenDet)=DBioB(i,k,iBenDet)+sinkOUT(i,k)*0.64_r8
---
> 		  DBioB(i,k,iBenDet)=DBioB(i,k,iBenDet)+sinkOUT(i,k)*0.79_r8
3394c3281
<                 if(k.eq.18) then
---
>                 if(k.eq.21) then
3419c3306
<  		  DBioB(i,k,iBenDet)=DBioB(i,k,iBenDet)+sinkOUT(i,k)*0.64_r8
---
>  		  DBioB(i,k,iBenDet)=DBioB(i,k,iBenDet)+sinkOUT(i,k)*0.79_r8
3426c3313
<                 if(k.eq.18) then
---
>                 if(k.eq.21) then
3450c3337
<  		  DBioB(i,k,iBenDet)=DBioB(i,k,iBenDet)+sinkOUT(i,k)*0.64_r8
---
>  		  DBioB(i,k,iBenDet)=DBioB(i,k,iBenDet)+sinkOUT(i,k)*0.79_r8
3457c3344
<                 if(k.eq.18) then
---
>                 if(k.eq.21) then
3480c3367
<  		  DBioB(i,k,iBenDet)=DBioB(i,k,iBenDet)+sinkOUT(i,k)*0.64_r8
---
>  		  DBioB(i,k,iBenDet)=DBioB(i,k,iBenDet)+sinkOUT(i,k)*0.79_r8
3487c3374
<                 if(k.eq.18) then
---
>                 if(k.eq.21) then
3594c3481
< !#if defined CLIM_ICE_1D	
---
> #if defined CLIM_ICE_1D	
3596c3483
< !#endif
---
> #endif
3600,3601c3487
<       
<      
---
> 
3602a3489
> 
3604,3606c3491
< 	  aiceIfrac=(1-exp(-alphaIb*Par1))*exp(-betaI*Par1)  !light limiting 
< 	  
< #ifdef CLIM_ICE_1D	   	  
---
>  	   	  
3609c3494,3495
<           	  
---
>           
> 	  
3610a3497
> 	  aiceIfrac=(1-exp(-alphaIb*Par1))*exp(-betaI*Par1)  !light limiting  
3612,3618d3498
< #elif defined BERING_10K  
< 	  cff1=IceNO3(i,j,nstp)/(ksnut1+IceNO3(i,j,nstp))                  
< 	  cff2=IceNH4(i,j,nstp)/(ksnut2+IceNH4(i,j,nstp))
<           	  
< 	  aiceNfrac=exp(-inhib*IceNH4(i,j,nstp))    
< 	   
< #endif		  
3636,3637c3516
< 	  
< #ifdef CLIM_ICE_1D 	
---
> 	
3640,3644c3519
< #elif defined BERING_10K  
< 	   DBioBI(i,iIcePhL)=DBioBI(i,iIcePhL)                 &
<      &	   + GROWAice*IcePhL(i,j,nstp)* dtdays  
< 	   
< #endif
---
> 
3657c3532
< #ifdef CLIM_ICE_1D
---
> 		
3660,3664c3535
< #elif defined BERING_10K  
< 	  DBioBI(i,iIcePhL)=DBioBI(i,iIcePhL)                 &
<      &	   -IcePhL(i,j,nstp)*RAi0*dtdays
< 	   
< #endif	
---
> 	
3669c3540
< # ifdef CLIM_ICE_1D
---
> 	
3692,3713d3562
< #elif defined BERING_10K  
< 	  DBioBI(i,iIcePhL)=DBioBI(i,iIcePhL)              &
<      &	        -IcePhL(i,j,nstp)*RgAi*dtdays
<      
<                                                
<        
< 	  reN=annit*IceNH4(i,j,nstp) 
< 		
< 	  cff2=IcePhL(i,j,nstp)*(GROWAice-RAi0)
< 	  cff3=IcePhL(i,j,nstp)*RAi0-reN
< 	
< 	
< 	
<   	  DBioBI(i,iIceNO3)=DBioBI(i,iIceNO3)              &
<      &	          -grow1*NOup*IcePhL(i,j,nstp)*xi*dtdays   &
<      &	          +reN*dtdays
< 	
<          DBioBI(i,iIceNH4)=DBioBI(i,iIceNH4)                  &
<      &	             -grow1*NHup*IcePhL(i,j,nstp)*xi*dtdays   &
<      &               +RAi0*IcePhL(i,j,nstp)*xi*dtdays         &
<      &	             +RgAi*IcePhL(i,j,nstp)*xi*dtdays         &
<      &               -reN*dtdays  
3715,3716d3563
< 	   
< #endif	
3718,3719c3565,3569
<  
< #ifdef CLIM_ICE_1D
---
>                              
> !
> 
> 
> 
3742c3592,3595
< #endif
---
> 
> !          st2(i,j,nnew,i2Stat3)=reN*dtdays
> !          st2(i,j,nnew,i2Stat4)=annit*BioBI(i,iIceNH4)   
> !	  st2(i,j,nnew,i2Stat5)=BioBI(i,iIceNH4)
3748c3601
< 
---
> #else
3750,3754c3603,3604
< #elif defined BERING_10K	 
<           cff1 = hi(i,j,nstp)/ai(i,j,nstp)
<           cff2=hi(i,j,nnew)/ai(i,j,nnew)
<           dhicedt=cff2-cff1
< 
---
> 	  dhicedt=it(i,j,nnew(ng),iIceZ)-it(i,j,nstp(ng),iIceZ)
> !	  dhicedt=(hi(i,j,nstp)-hi(i,j,nnew))
3757,3758c3607,3608
<   
<   
---
> 	  
> 	  
3764c3614
<  
---
> 	 
3768c3618
<                          
---
> 	                         
3780,3789c3630
< 	 
< #if defined CLIM_ICE_1D		  
<          DBioBI(i,iIcePhL)=DBioBI(i,iIcePhL)                     &
<      &	        + BioBI(i,iIcePhL)*(twi/aidz)*86400*dtdays
<      
<          DBio(i,N(ng),iPhL) = DBio(i,N(ng),iPhL)                &
<      &	    -twi*BioBI(i,iIcePhL)*dtdays*86400/Hz(i,j,N(ng))
< 
< #elif defined BERING_10K
<      
---
> 	  
3796,3797d3636
<      
< #endif 
3810c3649
< #if defined CLIM_ICE_1D   
---
> 	   
3822,3835c3661
< #elif defined BERING_10K
< 
<            cff1=twi*(Bio(i,N(ng),iNO3)-IceNO3(i,j,nstp))*dtdays
< 	   cff2=twi*(Bio(i,N(ng),iNH4)-IceNH4(i,j,nstp))*dtdays
< 	  
< 	     IF (twi.lt.0) THEN  
<  	   DBioBI(i,iIceNO3)=DBioBI(i,iIceNO3)                     &
<      &	                    + IceNO3(i,j,nstp)*twi*dtdays
< 	   
< 	   
<  	   DBioBI(i,iIceNH4)=DBioBI(i,iIceNH4)                     &
<      &	                    + IceNH4(i,j,nstp)*twi*dtdays
< 
< #endif 	 
---
> 	 
3840d3665
< #if defined CLIM_ICE_1D	   
3851c3676
< #endif   
---
>    
3854,3855c3679,3680
< 
< 
---
> 	  
> 	
3862,3863d3686
< 	   
< #if defined CLIM_ICE_1D		   
3874c3697
< #endif
---
>  
3890d3712
< #if defined CLIM_ICE_1D	
3892,3894d3713
< #elif defined BERING_10K
<            IF (IceLog(i,j,nstp).eq.1_r8 ) THEN
< #endif
3898d3716
< #if defined CLIM_ICE_1D		      
3908,3920d3725
< 	       
< #elif defined BERING_10K	       
< 	        DBio(i,N(ng),iPhL) = DBio(i,N(ng),iPhL)          &
<      &	             + IcePhL(i,j,nstp)*aidz/Hz(i,j,N(ng))
<        
<                DBio(i,N(ng),iNO3) = DBio(i,N(ng),iNO3)          &
<      &	             + IceNO3(i,j,nstp)*aidz/Hz(i,j,N(ng))
<                DBio(i,N(ng),iNH4) = DBio(i,N(ng),iNH4)          &
<      &	             + IceNH4(i,j,nstp)*aidz/Hz(i,j,N(ng))
<                IceLog(i,j,nstp) =-1_r8
<                IceLog(i,j,nnew) =-1_r8
< #endif	       
< #if defined CLIM_ICE_1D	       
3928c3733
<            
---
>               
3932,3934c3737
< #endif  
< #endif
<       
---
> #endif        
3936,3937c3739
< #if defined CLIM_ICE_1D	
<                 DO itrc=1,3 !NIB
---
>          DO itrc=1,3 !NIB
3943,3946d3744
< #elif defined BERING_10K   
<              DBioBI(i,iIceNO3)=DBioBI(i,iIceNO3)-IceNO3(i,j,nstp)
<              DBioBI(i,iIceNH4)=DBioBI(i,iIceNH4)-IceNH4(i,j,nstp)
<              DBioBI(i,iIcePhL)=DBioBI(i,iIcePhL)-IcePhL(i,j,nstp)
3948,3953d3745
< 	     IceNO3(i,j,nnew)=0_r8
<              IceNH4(i,j,nnew)=0_r8
<              IcePhL(i,j,nnew)=0_r8
< 	     IceLog(i,j,nstp) =0_r8
< #endif
<        
3957c3749
< #if defined CLIM_ICE_1D          
---
>           
3962,3968c3754,3757
< #elif defined BERING_10K   
<              DBioBI(i,iIceNO3)=0_r8
<              DBioBI(i,iIceNH4)=0_r8
<              DBioBI(i,iIcePhL)=0_r8
<            
< #endif	
< 
---
> 		
> !		 DBio(i,N(ng),iPhL)=0_r8      
> !                 DBio(i,N(ng),iNO3)=0_r8 
> !                 DBio(i,N(ng),iNH4)=0_r8 
3969a3759,3762
>         ENDIF 
> 
>         
> 
3971d3763
< 	  ENDIF
3973c3765,3769
< #   endif 
---
> 	
> #   endif
> 
> 
> 
4007d3802
< #if defined CLIM_ICE_1D	
4016,4024d3810
< #elif defined BERING_10K
< 
<             
< 	      IcePhL(i,j,nstp) = DBioBI(i,iIcePhL)    
<               IceNO3(i,j,nstp) = DBioBI(i,iIceNO3)     
<               IceNH4(i,j,nstp) = DBioBI(i,iIceNH4)       
< !              IceLog(i,j,nstp) = DBioBI(i,iIceLog)
< 
< #   endif 
4081d3866
< #if defined CLIM_ICE_1D	    
4086,4087c3871
< 
< 
---
>  
4094,4096d3877
< #elif defined BERING_10K
< 
< #   endif 
4150,4151c3931
<            
<           pt3(i,j,k,nnew,iPhSprd) = pt3(i,j,k,nstp,iPhSprd) +           &
---
>             pt3(i,j,k,nnew,iPhSprd) = pt3(i,j,k,nstp,iPhSprd) +           &
